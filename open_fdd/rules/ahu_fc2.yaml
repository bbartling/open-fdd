# AHU Fault Condition 2 â€” Mix temp too low
# MAT should be between OAT and RAT; fault if MAT < min(OAT, RAT)
name: mix_temp_too_low
description: Mix temperature too low; should be between outside and return air
type: expression
flag: fc2_flag
equipment_type: [AHU, VAV_AHU]

inputs:
  mat:
    brick: Mixed_Air_Temperature_Sensor
    column: mat
  rat:
    brick: Return_Air_Temperature_Sensor
    column: rat
  oat:
    brick: Outside_Air_Temperature_Sensor
    column: oat
  supply_vfd_speed:
    brick: Supply_Fan_Speed_Command
    column: supply_vfd_speed

params:
  mix_err_thres: 1.0
  return_err_thres: 1.0
  outdoor_err_thres: 1.0

expression: |
  (mat - mix_err_thres < np.minimum(rat - return_err_thres, oat - outdoor_err_thres)) & (supply_vfd_speed > 0.01)
