# Rule J â€” Discharge above blended in cooling (GL36-inspired)
name: sat_too_high_cooling_modes
description: SAT too high; should be less than MAT in econ+mech or mech-only cooling
type: expression
flag: rule_j_flag
equipment_type: [AHU, VAV_AHU]

inputs:
  Supply_Air_Temperature_Sensor:
    brick: Supply_Air_Temperature_Sensor
  Mixed_Air_Temperature_Sensor:
    brick: Mixed_Air_Temperature_Sensor
  Valve_Command:
    brick: Valve_Command
  Damper_Position_Command:
    brick: Damper_Position_Command

params:
  delta_t_supply_fan: 0.5
  mix_err_thres: 1.0
  supply_err_thres: 1.0
  ahu_min_oa_dpr: 0.1

expression: |
  (Supply_Air_Temperature_Sensor > Mixed_Air_Temperature_Sensor + np.sqrt(supply_err_thres**2 + mix_err_thres**2) + delta_t_supply_fan) & (((Damper_Position_Command > 0.9) & (Valve_Command > 0)) | ((Damper_Position_Command <= ahu_min_oa_dpr) & (Valve_Command > 0.9)))
